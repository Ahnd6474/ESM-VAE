
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ESM‑VAE — Structure‑Aware Protein VAE</title>

  <!-- Fonts & Icons -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />

  <!-- MathJax for LaTeX equations on GitHub Pages -->
  <script>
    window.MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$','$$'], ['\\[','\\]']] },
      svg: { fontCache: 'global' }
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

  <style>
    :root{
      --bg1:#0b1020;
      --bg2:#111827;
      --card:rgba(255,255,255,0.06);
      --text:#e5e7eb;
      --muted:#9ca3af;
      --accent:#22d3ee;
      --accent2:#a78bfa;
      --border:rgba(255,255,255,0.12);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      margin:0;
      font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;
      color:var(--text);
      background: radial-gradient(1200px 600px at 10% -10%, rgba(34,211,238,.25), transparent 40%),
                  radial-gradient(900px 600px at 120% 10%, rgba(167,139,250,.18), transparent 40%),
                  linear-gradient(120deg, var(--bg1), var(--bg2));
      min-height:100vh;
    }
    /* Top nav */
    .nav{
      position:sticky; top:0; z-index:50;
      backdrop-filter:saturate(140%) blur(10px);
      background:rgba(10,14,28,.65);
      border-bottom:1px solid var(--border);
    }
    .nav-inner{max-width:1100px;margin:0 auto;display:flex;align-items:center;gap:18px;padding:12px 16px}
    .brand{font-weight:900;letter-spacing:.5px}
    .brand .logo-dot{color:var(--accent)}
    .spacer{flex:1}
    .nav a{color:var(--text);text-decoration:none;padding:8px 10px;border-radius:8px;font-weight:600;font-size:.95rem}
    .nav a:hover{background:rgba(255,255,255,.06)}
    .toggle{
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:#0b1020;border:0;border-radius:999px;padding:9px 14px;font-weight:800;cursor:pointer
    }

    /* Layout */
    .container{max-width:1100px;margin:0 auto;padding:28px 16px}
    header.hero{
      padding:70px 0 36px;text-align:center;
      position:relative;
    }
    .hero h1{
      margin:0;
      font-size:clamp(2rem, 3vw + 1rem, 3.3rem);
      line-height:1.1;
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      -webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;
      font-weight:900;
    }
    .hero p{color:var(--muted);max-width:780px;margin:16px auto 0;line-height:1.7}
    .cta{
      margin-top:26px; display:flex;justify-content:center;gap:14px;flex-wrap:wrap
    }
    .button{
      display:inline-flex;align-items:center;gap:10px;
      background:linear-gradient(90deg,var(--accent),var(--accent2));
      color:#0b1020;font-weight:800;padding:12px 18px;border-radius:999px;text-decoration:none;border:0;
      box-shadow:0 10px 25px rgba(34,211,238,.25);
      transition:transform .18s ease, filter .18s ease
    }
    .button:hover{transform:translateY(-2px);filter:saturate(120%)}
    .button.secondary{
      background:transparent;color:var(--text);border:2px solid var(--accent);box-shadow:none
    }
    /* Cards */
    .grid{display:grid;grid-template-columns:1fr;gap:22px;margin-top:22px}
    .card{
      background:var(--card); border:1px solid var(--border); border-radius:var(--radius);
      padding:22px 22px 18px; position:relative; overflow:hidden
    }
    .card::after{
      content:""; position:absolute; inset:-2px; z-index:-1;
      background:radial-gradient(40% 60% at 10% -10%, rgba(34,211,238,.15), transparent 60%),
                 radial-gradient(50% 70% at 120% 10%, rgba(167,139,250,.10), transparent 60%);
      filter: blur(16px);
    }
    h2{margin:0 0 14px;font-size:1.55rem;display:flex;align-items:center;gap:10px}
    h2 .icon{color:var(--accent)}
    p{margin:10px 0}
    .muted{color:var(--muted)}
    .metrics{display:grid;grid-template-columns:repeat(auto-fit,minmax(230px,1fr));gap:12px;margin-top:8px}
    .metric{
      padding:14px;border:1px dashed var(--border);border-radius:14px;background:rgba(255,255,255,.03)
    }
    .metric b{font-size:1.1rem}
    .figure{margin-top:12px;text-align:center}
    .figure img{max-width:100%;border-radius:12px;border:1px solid var(--border)}
    .figure figcaption{font-size:.9rem;color:var(--muted);margin-top:8px}
    code,kbd{background:rgba(255,255,255,.05);border:1px solid var(--border);padding:2px 6px;border-radius:8px}
    pre{overflow:auto;background:rgba(0,0,0,.35);border:1px solid var(--border);border-radius:12px;padding:12px}

    /* Footer */
    footer{padding:38px 16px;text-align:center;color:var(--muted)}
    footer .sep{opacity:.4;margin:0 8px}

    /* Reveal on scroll */
    .reveal{opacity:0;transform:translateY(18px);transition:all .6s ease}
    .reveal.visible{opacity:1;transform:none}

    @media(min-width:980px){ .grid{grid-template-columns:1fr 1fr} }
  </style>
</head>
<body>

  <!-- NAV -->
  <div class="nav">
    <div class="nav-inner">
      <div class="brand">ESM<span class="logo-dot">‑</span>VAE</div>
      <a href="#about">About</a>
      <a href="#method">Method</a>
      <a href="#results">Results</a>
      <a href="#resources">Resources</a>
      <div class="spacer"></div>
      <button class="toggle" id="themeToggle"><i class="fa-solid fa-wand-magic-sparkles"></i>&nbsp;Glow</button>
    </div>
  </div>

  <!-- HERO -->
  <header class="hero container">
    <h1>Structure‑Aware Protein Variational Autoencoder</h1>
    <p>
      <b>ESM‑VAE</b> learns structure‑aware latent representations of proteins by aligning reconstructions to
      <b>pretrained ESM‑2 embeddings</b> (perceptual loss). It reaches <b>97.17%</b> reconstruction on UniRef50,
      achieves ProteinGym Spearman’s ρ of <b>0.7779 (≤512 aa)</b> / <b>0.689 (all)</b>, and attains FP tasks of
      <b>0.987</b> (5‑fold accuracy) with RMSE <b>2.7/3.8 nm</b> for absorption/emission. Training used a single
      <b>H200 (NVL) GPU</b> for roughly one day.
    </p>
    <div class="cta">
      <a class="button" href="https://github.com/Ahnd6474/ESM-VAE" target="_blank" rel="noopener">
        <i class="fa-brands fa-github"></i> GitHub
      </a>
      <a class="button secondary" href="docs/ESM_VAE.pdf" target="_blank" rel="noopener">
        <i class="fa-solid fa-file-pdf"></i> Paper (PDF)
      </a>
    </div>
  </header>

  <!-- CONTENT -->
  <main class="container grid">

    <!-- About -->
    <section id="about" class="card reveal">
      <h2><i class="fa-solid fa-dna icon"></i> About</h2>
      <p>
        ESM‑VAE is a lightweight transformer VAE (~5.5M params) that addresses common issues of sequence‑only VAEs
        (limited generalization, weak reconstruction) by adding a structural perceptual term computed on pretrained
        ESM‑2 embeddings. The latent space is encouraged to remain active (mean KL ≈ 0.05) and informative.
      </p>
      <figure class="figure">
        <img src="img/struct.png" alt="ESM‑VAE overview diagram">
        <figcaption>Overview — encoder/decoder with perceptual alignment using pretrained ESM‑2 embeddings.</figcaption>
      </figure>
    </section>

    <!-- Method -->
    <section id="method" class="card reveal">
      <h2><i class="fa-solid fa-diagram-project icon"></i> Method</h2>
      <p class="muted">Two‑phase training with perceptual alignment; equations rendered via MathJax.</p>

      <p><b>Phase‑1 (teacher‑forced)</b></p>
      <p>
        $$
        L_{\text{phase1}} \;=\; \lambda\,(L_{\text{COS}}+L_{\text{MSE}}) \;+\; \alpha\,L_{\text{CE}} \;+\; \beta\,L_{\text{KL}}\,.
        $$
      </p>
      <p class="muted">Perceptual terms are computed on <b>pretrained ESM‑2 embeddings</b>.</p>

      <p><b>Phase‑2 (free‑running, GPT‑style)</b></p>
      <p>
        $$
        L_{\text{phase2}} \;=\; L_{\text{CE}}(\tilde{x}) \;+\; \beta\,L_{\text{KL}} \;+\; \lambda\,L_{\text{COS}}\!\big(\mathrm{ESM2}(x_{\text{orig}}),\,\mathrm{ESM2}(\tilde{x})\big)\,.
        $$
      </p>
      <p class="muted">Drop MSE; warm up $\lambda$; truncated rollouts K ≈ 64–256.</p>
    </section>

    <!-- Results -->
    <section id="results" class="card reveal">
      <h2><i class="fa-solid fa-chart-line icon"></i> Results</h2>
      <div class="metrics">
        <div class="metric">
          <b>Reconstruction</b><br/>
          UniRef50 held‑out: <b>97.17%</b>.
        </div>
        <div class="metric">
          <b>ProteinGym (DMS)</b><br/>
          Spearman’s ρ: <b>0.7779</b> (≤512 aa), <b>0.689</b> (all 217).
        </div>
        <div class="metric">
          <b>FP downstream tasks</b><br/>
          5‑fold Acc: <b>0.987</b>; RMSE: <b>2.7/3.8 nm</b> (λ_abs/λ_em).
        </div>
        <div class="metric">
          <b>Compute</b><br/>
          Single <b>H200 (NVL)</b>, ~1 day.
        </div>
      </div>
      <figure class="figure">
        <img src="https://github.com/Ahnd6474/ESMS-VAE/blob/main/img/compare.png?raw=true" alt="ProteinGym comparison">
        <figcaption>ProteinGym correlation summary (illustrative). Replace with your actual figure.</figcaption>
      </figure>
    </section>

    <!-- Resources -->
    <section id="resources" class="card reveal">
      <h2><i class="fa-solid fa-box-archive icon"></i> Resources</h2>
      <ul>
        <li>Code & models: <a href="https://github.com/Ahnd6474/ESM-VAE" target="_blank" rel="noopener">github.com/Ahnd6474/ESM‑VAE</a></li>
        <li>Paper PDF (place in repo): <code>docs/ESM_VAE.pdf</code></li>
        <li>Overview figure (place in repo): <code>docs/figs/esm_vae_overview.png</code></li>
      </ul>
      <p class="muted">Tip: Put this file at <code>docs/index.html</code> in your repo and enable GitHub Pages (branch: <code>main</code>, folder: <code>/docs</code>).</p>
    </section>

  </main>

  <footer>
    <div>© 2025 ESM‑VAE — Daegu Science High School</div>
    <div class="muted">Contact: <a href="mailto:ahnd6474@gmail.com" style="color:var(--text)">ahnd6474@gmail.com</a>
      <span class="sep">•</span> Repository: <a href="https://github.com/Ahnd6474/ESM-VAE" target="_blank" rel="noopener" style="color:var(--text)">ESM‑VAE</a>
    </div>
  </footer>

  <script>
    // Simple reveal-on-scroll
    const io = new IntersectionObserver((entries)=>{
      entries.forEach(e=>{ if(e.isIntersecting){ e.target.classList.add('visible'); io.unobserve(e.target); } });
    }, { threshold: 0.12 });
    document.querySelectorAll('.reveal').forEach(el=>io.observe(el));

    // Glow toggle (adds stronger background highlights)
    const toggle = document.getElementById('themeToggle');
    let glow=false;
    toggle.addEventListener('click', ()=>{
      glow=!glow;
      document.body.style.background = glow
        ? `radial-gradient(1200px 600px at 10% -10%, rgba(34,211,238,.40), transparent 40%),
            radial-gradient(900px 600px at 120% 10%, rgba(167,139,250,.28), transparent 40%),
            linear-gradient(120deg, var(--bg1), var(--bg2))`
        : `radial-gradient(1200px 600px at 10% -10%, rgba(34,211,238,.25), transparent 40%),
            radial-gradient(900px 600px at 120% 10%, rgba(167,139,250,.18), transparent 40%),
            linear-gradient(120deg, var(--bg1), var(--bg2))`;
    });
  </script>
</body>
</html>
